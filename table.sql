
DROP TABLE component_parents;
DROP TABLE components;

sp_help 'components';
sp_help 'component_parents';

CREATE TABLE components (
    id varchar(50) PRIMARY KEY,
	[desc] varchar(225),
    inv varchar(4),
);

CREATE TABLE component_parents (
    component_id varchar(50),
    parent_id varchar(50),
    net decimal(10, 2),
    PRIMARY KEY (component_id, parent_id, net),
    FOREIGN KEY (component_id) REFERENCES components(id),
    FOREIGN KEY (parent_id) REFERENCES components(id)
);

SELECT * FROM components;


INSERT INTO components (id) VALUES
('F-ACDP-105D31L-B8C3-AP-PRA0');


INSERT INTO components (id, [desc], inv) VALUES
('I-ACDP-105D31L-B8C3-AP-PRA1','105D31L 18 PE F-C C5 ASP PR-A ','ea'),
('W-CP00-D31XXXX-0421-AP-PRA0','CP D31 LC-421 NAT ASPIRA PRE  ','ea' ),
('W-CV02-D31LXXX-C03N-NL-DG00','CV D31L BLACK HD-ORANGE       ','ea' ),
('M-PLMA-NATURAL-0000-PP-0000','PP NATURAL (GENERAL)          ','kg' ),
('M-MABA-112PXXX-BLAC-JP-0000','MABA BLACK JP-112P            ','kg' ),
('M-MABA-71036BX-ORAN-MK-0000','MABA ORANGE MK-71036B         ','kg' ),
('K-BUSH-B10A14X-PBSB-00-0000','BUSHING B10-A14               ','ea' ),
('K-BUSH-B10A15X-PBSB-00-0000','BUSHING B10-A15               ','ea' ),
('K-SCDA-DANGERX-V001-00-0000','STICKER DANGER                ','ea' ),
('W-CACP-105D31X-B8C3-FO-C000','CELL 105D31-18 PE CV FO C5 COS','ea' ),
('W-FOCP-CG85PXX-L870-02-7S00','FORM CUT PLATE CG85 POS L8-7  ','ea'), 
('W-FOPL-CG85PXX-L870-02-7S00','FORM PLATE CG85 POS L8-7      ','pn'), 
('W-UNPL-CG85PXX-L870-02-7S00','UNFORM PLATE CG85 POS L8-7    ','pn'), 
('W-GRID-CG85XXX-SBCS-02-0000','GRID CG85                     ','pn'), 
('W-PAST-L87XXXP-9997-00-0000','PASTA L8-7 99,97%             ','kg' ),
('M-PULE-9997XXX-0000-00-2600','PURE LEAD 99,97%              ','kg' ),
('W-MCDI-ASAMSUL-0000-00-1400','ASAM SULFAT (H2SO4) 1400      ','l' ),
('C-MCDI-ASAMSUL-0000-00-1800','ASAM SULFAT (H2SO4) 1800      ','kg' ),
('W-FOCP-CG87NXX-T3A0-02-7S00','FORM CUT PLATE CG87 NEG VT-3A ','ea'), 
('W-FOPL-CG87NXX-T3A0-02-7S00','FORM PLATE CG87 NEG VT-3A     ','pn'), 
('W-UNPL-CG87NXX-T3A0-02-7S00','UNFORM PLATE CG87 NEG VT-3A   ','pn'), 
('W-GRID-CG87XXX-SBCS-02-0000','GRID CG87                     ','pn'), 
('M-LEAL-PBSBXXX-0170-00-2600','PBSB 1,7%                     ','kg' ),
('W-PAST-VT3AXXN-9997-00-0000','PASTA VT-3A 99,97%            ','kg' ),
('W-LEPO-9997XXX-0000-00-0000','LEAD POWDER 99,97%            ','kg' ),
('W-SEPA-0801600-25CG-PE-00N0','WIP SEPA PE 0,8 X 160 MM - CG ','ea'), 
('K-SEPA-0801600-25RA-PE-00N0','SEPA PE 0,8 X 160 MM ROLL     ','m2' ),
('W-LESR-D31XXXX-00SC-SB-0275','L-STRAP D31 SL COS (CB3)      ','ea' ),
('M-LEAL-PBSBXXX-0275-00-2600','PBSB 2,75% (CB3)              ','kg' ),
('W-STSE-D31XXXX-8A50-03-0000','STY-SET D31 VP-G18A50 ORANGE  ','ea' ),
('K-STSE-D31XXXX-8A50-03-0000','STY-SET D31 VP-G18A50 ORANGE  ','ea' ),
('W-VP03-G18A50X-22B2-NL-VPR0','VENT PLUG G18-A50 ORANGE      ','ea' ),
('K-RUSE-2201500-20BL-00-EPDM','SEAL OD-22 ID-15 T-2 MM       ','ea' ),
('K-KBDC-D31XXXX-RSC0-AP-PRA0','K-BOX D31 ASPIRA PREMIUM      ','ea' ),
('K-SCTY-105D31L-00TB-CV-V06A','STIC TYPE CONV 105D31L V06    ','ea' ),
('K-SCTY-105D31L-00TC-CV-V07A','STIC TYPE CONV 105D31L V07    ','ea' ),
('K-ACWC-ASPIRAX-0000-EN-SN00','WARANTY CARD ASPIRA ENG + SN  ','ea' ),
('K-PALL-E2AXXXX-WOOD-HT-0000','PALLET E2A - HT               ','ea')
;


INSERT INTO component_parents (component_id, parent_id, net) VALUES
('I-ACDP-105D31L-B8C3-AP-PRA1','F-ACDP-105D31L-B8C3-AP-PRA0','1.00'),
('W-CP00-D31XXXX-0421-AP-PRA0','I-ACDP-105D31L-B8C3-AP-PRA1','1.00' ),
('M-PLMA-NATURAL-0000-PP-0000','W-CP00-D31XXXX-0421-AP-PRA0','0.87' ),
('W-CV02-D31LXXX-C03N-NL-DG00','I-ACDP-105D31L-B8C3-AP-PRA1','1.00' ),
('M-PLMA-NATURAL-0000-PP-0000','W-CV02-D31LXXX-C03N-NL-DG00','0.18' ),
('M-MABA-112PXXX-BLAC-JP-0000','W-CV02-D31LXXX-C03N-NL-DG00','0.00' ),
('M-MABA-71036BX-ORAN-MK-0000','W-CV02-D31LXXX-C03N-NL-DG00','0.00' ),
('K-BUSH-B10A14X-PBSB-00-0000','W-CV02-D31LXXX-C03N-NL-DG00','1.00' ),
('K-BUSH-B10A15X-PBSB-00-0000','W-CV02-D31LXXX-C03N-NL-DG00','1.00' ),
('K-SCDA-DANGERX-V001-00-0000','W-CV02-D31LXXX-C03N-NL-DG00','1.00' ),
('W-CACP-105D31X-B8C3-FO-C000','I-ACDP-105D31L-B8C3-AP-PRA1','6.00' ),
('W-FOCP-CG85PXX-L870-02-7S00','W-CACP-105D31X-B8C3-FO-C000','54.00'), 
('W-FOPL-CG85PXX-L870-02-7S00','W-FOCP-CG85PXX-L870-02-7S00','27.00'), 
('W-UNPL-CG85PXX-L870-02-7S00','W-FOPL-CG85PXX-L870-02-7S00','27.00'), 
('W-GRID-CG85XXX-SBCS-02-0000','W-UNPL-CG85PXX-L870-02-7S00','27.00'), 
('M-LEAL-PBSBXXX-0170-00-2600','W-GRID-CG85XXX-SBCS-02-0000','2.30'),
('W-PAST-L87XXXP-9997-00-0000','M-LEAL-PBSBXXX-0170-00-2600','4.29'),
('W-LEPO-9997XXX-0000-00-0000','W-PAST-L87XXXP-9997-00-0000','3.35'),
('M-PULE-9997XXX-0000-00-2600','W-LEPO-9997XXX-0000-00-0000','3.17'),
('W-MCDI-ASAMSUL-0000-00-1400','M-PULE-9997XXX-0000-00-2600','0.46'),
('C-MCDI-ASAMSUL-0000-00-1800','W-MCDI-ASAMSUL-0000-00-1400','0.23'),
('W-FOCP-CG87NXX-T3A0-02-7S00','W-CACP-105D31X-B8C3-FO-C000','54.00'), 
('W-FOPL-CG87NXX-T3A0-02-7S00','W-FOCP-CG87NXX-T3A0-02-7S00','27.00'), 
('W-UNPL-CG87NXX-T3A0-02-7S00','W-FOPL-CG87NXX-T3A0-02-7S00','27.00'), 
('W-GRID-CG87XXX-SBCS-02-0000','W-UNPL-CG87NXX-T3A0-02-7S00','27.00'), 
('M-LEAL-PBSBXXX-0170-00-2600','W-GRID-CG87XXX-SBCS-02-0000','1.97'),
('W-PAST-VT3AXXN-9997-00-0000','M-LEAL-PBSBXXX-0170-00-2600','3.94'),
('W-LEPO-9997XXX-0000-00-0000','W-PAST-VT3AXXN-9997-00-0000','3.27'),
('M-PULE-9997XXX-0000-00-2600','W-LEPO-9997XXX-0000-00-0000','3.10'),
('W-MCDI-ASAMSUL-0000-00-1400','M-PULE-9997XXX-0000-00-2600','0.25'),
('C-MCDI-ASAMSUL-0000-00-1800','W-MCDI-ASAMSUL-0000-00-1400','0.12'),
('W-SEPA-0801600-25CG-PE-00N0','W-CACP-105D31X-B8C3-FO-C000','54.00'), 
('K-SEPA-0801600-25RA-PE-00N0','W-SEPA-0801600-25CG-PE-00N0','2.01'),
('W-LESR-D31XXXX-00SC-SB-0275','W-CACP-105D31X-B8C3-FO-C000','6.00'),
('M-LEAL-PBSBXXX-0275-00-2600','W-LESR-D31XXXX-00SC-SB-0275','1.02'),
('W-STSE-D31XXXX-8A50-03-0000','F-ACDP-105D31L-B8C3-AP-PRA0','1.00'),
('K-STSE-D31XXXX-8A50-03-0000','W-STSE-D31XXXX-8A50-03-0000','1.00'),
('W-VP03-G18A50X-22B2-NL-VPR0','W-STSE-D31XXXX-8A50-03-0000','6.00'),
('M-PLMA-NATURAL-0000-PP-0000','W-VP03-G18A50X-22B2-NL-VPR0','0.02'),
('M-MABA-71036BX-ORAN-MK-0000','W-VP03-G18A50X-22B2-NL-VPR0','0.00'),
('K-RUSE-2201500-20BL-00-EPDM','W-VP03-G18A50X-22B2-NL-VPR0','6.00'),
('K-KBDC-D31XXXX-RSC0-AP-PRA0','F-ACDP-105D31L-B8C3-AP-PRA0','1.00'),
('K-SCTY-105D31L-00TB-CV-V06A','F-ACDP-105D31L-B8C3-AP-PRA0','1.00'),
('K-SCTY-105D31L-00TC-CV-V07A','F-ACDP-105D31L-B8C3-AP-PRA0','1.00'),
('K-ACWC-ASPIRAX-0000-EN-SN00','F-ACDP-105D31L-B8C3-AP-PRA0','1.00'),
('K-PALL-E2AXXXX-WOOD-HT-0000','F-ACDP-105D31L-B8C3-AP-PRA0','0.01')
;

SELECT c.id AS component_id, c.[desc] AS component_desc, c.inv AS component_inv,
       cp.parent_id AS parent_id, p.[desc] AS parent_desc, p.inv AS parent_inv, cp.net
FROM components c
LEFT JOIN component_parents cp ON c.id = cp.component_id
LEFT JOIN components p ON cp.parent_id = p.id;
